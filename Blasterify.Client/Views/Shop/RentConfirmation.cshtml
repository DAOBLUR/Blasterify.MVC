@{
    ViewBag.Title = "RentConfirmation";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<div class="container my-5">
    <div id="layoutAuthentication_content">
        <main>
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-5">
                        <div class="card shadow-lg border-0 rounded-lg mt-5">
                            <div class="card-header">
                                <h3 class="text-center font-weight-light my-4">Rent Confirmation</h3>
                            </div>

                            <div class="card-body">
                                <form action="@Url.Action("LogIn","Access")" method="post">
                                    <div class="form-floating mb-3">
                                        <p>Card Number</p>
                                        <p class="ms-3">**** **** **** 3456</p>
                                    </div>

                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <div class="form-floating mb-3 mb-md-0">
                                                <input name="expirationDate" class="form-control" id="inputExpirationDate" type="date" placeholder="12/2024" />
                                                <label for="inputExpirationDate">Expiration date</label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-floating mb-3 mb-md-0">
                                                <input type="password" placeholder="***" class="form-control" id="inputCVV" onkeypress="return event.charCode >= 48 && event.charCode <= 57" maxlength="3" />
                                                <label for="inputCCV">CVV</label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-floating mb-3">
                                        <input name="cardholderName" class="form-control" id="inputCardholderName" type="text" placeholder="John Doe" />
                                        <label for="inputCardholderName">Cardholder name</label>
                                    </div>
                                </form>
                            </div>

                            <div class="mt-2 mb-0 mx-3">
                                <div class="d-grid">
                                    <button class="btn btn-warning btn-block fw-bold" id="payNow" type="submit">Pay Now</button>
                                </div>
                            </div>

                            <div class="mt-4 mb-5 mx-3">
                                <div class="d-grid">
                                    <button class="btn btn-danger btn-block fw-bold" id="cancel" type="submit">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

@section scripts{
    <script>
        $(document).ready(function () {
            ShowCartCount(0);
        });

        //PAY NOW
        $(document).on('click', '#payNow', function ()
        {
            var pay = {
                expirationDate: $('#inputExpirationDate').val(),
                cvv: $('#inputCVV').val(),
                cardholderName: $('#inputCardholderName').val()
            };

            if (pay.expirationDate == null || pay.expirationDate == '') {
                swal('', 'You must enter a expiration date', 'warning');
                return;
            }
            else if (pay.cvv == null || pay.cvv == '') {
                swal('', 'You must enter your CVV', 'warning');
                return;
            }
            else if (pay.cvv.length != 3) {
                swal('', 'Invalid CVV', 'warning');
                return;
            }
            else if (pay.cardholderName == null || pay.cardholderName == '') {
                swal('', 'You must enter your cardholder name', 'warning');
                return;
            }

            jQuery.ajax({
                url: '@Url.Action("PayNowRequest", "Shop")',
                type: 'POST',
                data: JSON.stringify({ expirationDate: pay.expirationDate, cvv: pay.cvv, cardholderName: pay.cardholderName }),
                datatype: 'json',
                contentType: "application/json; charset=utf-8",
                success: function (response) {
                    console.log(response);
                    if (response.Success) {
                        window.location.href = response.Data.Url;
                    }
                    else {
                        swal('', 'Error', 'warning');
                    }
                },
            });
        });

        //CANCEL
        $(document).on('click', '#calcel', function ()
        {
            jQuery.ajax({
                url: '@Url.Action("CancelRentConfirmationRequest", "Shop")',
                type: 'POST',
                datatype: 'json',
                contentType: "application/json; charset=utf-8",
                success: function (response) {
                    console.log(response);
                    if (response.Success) {
                        window.location.href = response.Data.Url;
                    }
                    else {
                        swal('', 'Error', 'warning');
                        if (response) {
                            window.location.href = response.Data.Url;
                        }
                    }
                },
            });
        });

    </script>
}